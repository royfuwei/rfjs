name: Version (release)

on:
    pull_request_target:
        branches: [release]
        types: [closed]

permissions:
    contents: write
    pull-requests: write

concurrency:
    group: version-release
    cancel-in-progress: false

jobs:
    version:
        if: >
            github.event.pull_request.merged == true &&
            github.event.pull_request.head.repo.full_name == github.repository
        uses: royfuwei/rf-devops/.github/workflows/_changesets-version-channel.yml@main
        secrets:
            GIT_TOKEN: ${{ secrets.GIT_TOKEN }}
        with:
            ref: release
            channel: stable
            node_version: 20.x
